# 在线表格处理工具

## 项目简介

在线表格处理工具是一款专为团队协作设计的表格管理系统，能够自动切分大型表格，支持权限控制下的分布式填报，并自动汇总形成完整表格。该系统解决了传统表格协作中的数据同步困难、权限管理复杂等问题，提高了团队协作效率。

## 功能特性

### 📁 表格管理
- **表格上传**：支持 .xls/.xlsx/.csv 格式文件上传
- **智能解析**：自动解析表格数据，提取表头和数据行
- **表格拆分**：根据指定条件自动拆分表格，生成多个子表格

### 📋 任务管理
- **任务创建**：基于上传的表格创建处理任务
- **条件设置**：配置表格拆分条件和填报要求
- **任务发布**：生成可共享的填报链接
- **进度跟踪**：实时查看任务处理状态和子任务完成情况

### 🔒 权限控制
- **权限设置**：为不同填报对象设置不同的权限
- **数据隔离**：确保填报者只能看到和修改自己负责的数据
- **操作限制**：防止误操作和数据填写错误

### 📊 数据填报与汇总
- **在线填报**：支持在浏览器中直接填写表格数据
- **实时保存**：自动保存填写进度，防止数据丢失
- **数据验证**：确保填写的数据格式正确
- **汇总导出**：一键汇总所有子表格数据，生成完整Excel文件

## 技术栈

### 前端
- **Vue 3**：采用Composition API，提供高效的组件开发体验
- **Vite**：快速的构建工具，提供热更新和优化的构建输出
- **Element Plus**：基于Vue 3的UI组件库，提供丰富的界面组件
- **Pinia**：轻量级的状态管理库，管理应用的全局状态
- **Vue Router**：官方路由管理器，实现页面导航
- **Axios**：HTTP客户端，处理前后端数据交互
- **XLSX**：表格处理库，实现Excel文件的读取和导出
- **Handsontable**：强大的表格编辑组件，提供类似Excel的编辑体验

### 后端
- **Node.js**：JavaScript运行时，构建高效的后端服务
- **Express**：简洁的Web应用框架，处理HTTP请求
- **SQLite3**：轻量级的关系型数据库，存储任务和表格数据
- **CORS**：跨域资源共享，支持前后端分离架构

## 项目结构

```
OnlineExcel/
├── backend/                # 后端服务
│   ├── controllers/       # 控制器层，处理请求和响应
│   ├── routes/            # 路由配置，定义API接口
│   ├── services/          # 业务逻辑层，处理核心业务
│   ├── app.js             # 应用入口
│   ├── db.js              # 数据库配置
│   └── package.json       # 后端依赖配置
├── frontend/              # 前端应用
│   ├── public/            # 静态资源
│   ├── src/               # 源代码
│   │   ├── api/           # API接口定义
│   │   ├── assets/        # 资源文件
│   │   ├── components/    # 可复用组件
│   │   ├── hooks/         # 自定义钩子
│   │   ├── router/        # 路由配置
│   │   ├── stores/        # 状态管理
│   │   ├── utils/         # 工具函数
│   │   ├── views/         # 页面组件
│   │   ├── App.vue        # 根组件
│   │   └── main.js        # 应用入口
│   ├── index.html         # HTML模板
│   ├── package.json       # 前端依赖配置
│   └── vite.config.js     # Vite配置
├── .gitignore             # Git忽略文件
└── README.md              # 项目说明文档
```

## 快速开始

### 环境要求
- Node.js 16+ 
- npm 或 yarn

### 安装与运行

#### 1. 克隆仓库

```bash
git clone <仓库地址>
cd OnlineExcel
```

#### 2. 启动后端服务

```bash
cd backend
npm install
node app.js
```

后端服务默认运行在 http://localhost:3000

#### 3. 启动前端服务

```bash
cd frontend
npm install
npm run dev
```

前端服务默认运行在 http://localhost:5173

### 构建生产版本

```bash
# 构建前端
cd frontend
npm run build

# 后端无需构建，直接运行即可
```

## 使用说明

### 1. 创建任务

1. 访问首页 http://localhost:5173
2. 点击"上传表格开始任务"按钮
3. 选择要上传的表格文件
4. 等待文件解析完成后，系统会自动跳转至任务生成页面

### 2. 表格拆分

1. 在任务生成页面，选择要拆分的列
2. 系统会根据选择的列自动拆分表格
3. 确认拆分结果后，点击"下一步"进入条件设置页面

### 3. 设置任务条件

1. 输入任务名称和填表说明
2. 配置权限设置（可选）
3. 点击"发布任务"生成填报链接

### 4. 发布和分发任务

1. 在任务发布页面，查看生成的子表格列表
2. 点击"一键导出链接"复制所有子表格的填报链接
3. 将链接分发给相应的填报人员

### 5. 数据填报

1. 填报人员通过链接访问表格填写页面
2. 按照要求填写表格数据
3. 填写完成后点击"提交"按钮

### 6. 数据汇总

1. 任务发布者在任务发布页面查看各子表格的填写状态
2. 点击"汇总导出数据"按钮，将所有已提交的表格数据汇总为一个完整的Excel文件
3. 下载并查看汇总结果

## 核心页面说明

### Home.vue
- 首页，提供表格上传入口
- 显示历史任务列表
- 支持根据任务ID跳转至任务页面

### TaskGeneration.vue
- 任务生成页面
- 提供表格拆分功能
- 显示拆分结果预览

### TaskCondition.vue
- 条件设置页面
- 配置任务信息和权限设置
- 发布任务

### TaskRelease.vue
- 任务发布页面
- 显示子表格列表和填报链接
- 跟踪子任务完成情况
- 提供数据汇总导出功能

### TableFilling.vue
- 表格填写页面
- 提供在线表格编辑功能
- 支持数据验证和保存

## 开发指南

### 前端开发

1. 进入前端目录：`cd frontend`
2. 安装依赖：`npm install`
3. 启动开发服务器：`npm run dev`
4. 代码修改会实时反映在浏览器中

### 后端开发

1. 进入后端目录：`cd backend`
2. 安装依赖：`npm install`
3. 启动后端服务：`node app.js`
4. 建议使用 `nodemon` 实现热重载：`npm install -g nodemon && nodemon app.js`

### 数据库

- 项目使用SQLite3作为数据库，数据存储在 `backend/data.db` 文件中
- 数据库结构会在首次运行时自动创建
- 如需重置数据库，可删除 `data.db` 文件后重新启动服务
